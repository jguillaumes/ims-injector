# IMS Transactions injector

This tool allows to inject IMS transactions using IMS Connect. It's based on the sample C program included in the redbook "MS Connectivity in an On
Demand Environment: A Practical Guide to IMS Connectivity" - SG246794, which a group of IBM customers (including yours trully) and engineers wrote back in 2005.

The C sample was writtem to exercise all the choices offered by the IMS Connect network protocol. This tool does not need that, since its goal is simply to send transactions to the mainframe. Hence, the transactions are always sent using CM0 (commit-then-send) send-receive interactions. The transactions are read from a plain text file, with one transaction per line. That means they must be single segment and take text data as input. Transactions with embedded binary or packed data are not supported.

The responses are saved to a file, using the tags <resp>...</resp> to delimit each transaction. The response can be multisegment, and each segment is placed in a separate line. If the response contains embedded binaries or packeds, IMS Connect will corrupt them when converting the message from EBCDIC to ASCII. The value saved in the output file is that probably corrupted one.

## Installation

Assuming you have a correctly setup go environent, just do:

```
go install github.com/jguillaumes/ims-injector@latest
```

The package will be downloaded and built, and the resulting binary should be in your PATH. The binary has no runtime dependencies (out of the operating system) so you can move it whenever you like.

## Usage

### Transaction file

As mentioned above, you should put the transactions you want to run in a text file:

- Each transaction must be in its own line.
- Blank or empty lines will be ignored.
- If the line has less than 8 characters, it will be padded with blanks as sent as a transaction code only.
- You should not use non-ascii characters. If you do the results are impredictible and depend on the codepage conversion configured in the mainframe side. **This tool does not perform any kind of codeset conversion**.

You can name the file whatever you want, and there is no default or assumed file extension.

### Execution

The tool must be executed from the command line or from a script. The command syntax is as follows:

```
	ims-injector [options] <input file> <output file>
```
The options are:

```
	-h <host>	   The host name or IP address of the IMS system (No default, required)
	-p <port>	   The port number of the IMS system (Default: 4200)
	-d <datastore> The datastore name (No default, required)
	-t <timeout>   The timeout in seconds for the transaction (Default: 30)
	-u <user>	   The user name to connect to the IMS system (No default, required if OTMA security is enabled)
	-w <password>  The password to connect to the IMS system (No default, required if OTMA security is enabled)
	-c <clientid>  The client ID to use for the connection (Default: generated by the IMS system)
	-t <lterm>	   The logical terminal name to use for the connection (Default: "INJECTOR")
	-k <concurrent> The number of concurrent transactions to send (Default: 1)
	-v             Enable verbose logging (Default: false)
```

The host name can be specified as a domain name or as an IPv4 address.

Be aware the **password is sent as clear text**. This tool does not support TLS/SSL yet.

### Concurrency

The `-k` flag is not yet functional at this point, and it is ignored if specified. The plan is to be able to set up multiple threads (goroutines, actually) sending transactions concurrently. At this time, as said, this is not implemented and all the transactions are sent serially and synchronously.

## Environment

This tool has been tested under windows, macos and linux. It _should_ build in USS using the IBM Go compiler, but I've not been able to test it yet.

